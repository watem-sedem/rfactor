<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Application of rfactor on data det Flanders &mdash; rfactor 0.0.post1.dev348+g8f28442.d20211209 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Code legacy" href="../codelegacy.html" />
    <link rel="prev" title="rfactor package" href="../api/rfactor.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> rfactor
          </a>
              <div class="version">
                0.0.post1.dev348+g8f28442.d20211209
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../rfactor.html">R-factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-started.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">Module Reference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Application on Flanders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../codelegacy.html">Code legacy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">rfactor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Application of rfactor on data det Flanders</li>
      <li class="wy-breadcrumbs-aside">
            <a href="https://github.com/cn-ws/rfactor/tree/master/docs/notebooks/analysis_flanders.ipynb">View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Application-of-rfactor-on-data-det-Flanders">
<h1>Application of rfactor on data det Flanders<a class="headerlink" href="#Application-of-rfactor-on-data-det-Flanders" title="Permalink to this headline"></a></h1>
<section id="Aim">
<h2>Aim<a class="headerlink" href="#Aim" title="Permalink to this headline"></a></h2>
<p>Implementation to compute and analyse the R-factor of the RUSLE-equation. The R-factor is a measure for the total erosivity of a number of rainfall events within a defined timeframe (year, month, number of days). The factor is computed by calculating the yearly sum of -for every rainfall event- the sum of the depth of rainfall (mm) and the kinetic energy, and taking the mean over all years.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>NOTE</strong></p></td>
</tr>
<tr class="row-even"><td><p>This notebook does not
include the erosivity
computation based on the
Royal Meteorological
Institute of Belgium
(RMI) rainfall data, as
the data is not
available as open data.
One can contact RMI to
obtain the rainfall
input data.
Alternatively, the
results of the
computation of the
erosivity values based
on the RMI data are
provided in this
notebook as well as
other rainfall input
data, so one can proceed
with the analysis.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="Package-imports">
<h2>Package imports<a class="headerlink" href="#Package-imports" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<p>Load the <code class="docutils literal notranslate"><span class="pre">rfactor</span></code> package functionalities</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rfactor</span> <span class="kn">import</span> <span class="n">compute_erosivity</span><span class="p">,</span> <span class="n">maximum_intensity</span><span class="p">,</span> <span class="n">maximum_intensity_matlab_clone</span>
<span class="kn">from</span> <span class="nn">rfactor.process</span> <span class="kn">import</span> <span class="n">load_rain_folder</span><span class="p">,</span> <span class="n">compute_rainfall_statistics</span><span class="p">,</span> <span class="n">get_rfactor_station_year</span>
</pre></div>
</div>
</div>
</section>
<section id="Input-data-and-compute-erosivity">
<h2>Input data and compute erosivity<a class="headerlink" href="#Input-data-and-compute-erosivity" title="Permalink to this headline"></a></h2>
<p><strong>Set folders</strong></p>
<p>The main function <code class="docutils literal notranslate"><span class="pre">compute_erosivity</span></code> requires a <a class="reference external" href="https://pandas.pydata.org/docs/index.html">pandas DataFrame</a> containing <strong>non-zero</strong> rainfall data with the following columns:</p>
<ul class="simple">
<li><p>datetime (pd.Timestamp): Time stamp</p></li>
<li><p>rain_mm (float): Rain in mm</p></li>
<li><p>station (str): Measurement station identifier</p></li>
</ul>
<p>However, the legacy format of the input files used in the original Matlab implementation is still supported as well. For this format, te input files are defined by text files (extension: <code class="docutils literal notranslate"><span class="pre">txt</span></code>) that hold <strong>non-zero rainfall</strong> timeseries. The data are split per station and per year with a specific data file tag <code class="docutils literal notranslate"><span class="pre">STATION_YYYY</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>KMI_6414_2004.txt
KMI_6414_2005.txt
...
KMI_6434_2003.txt
KMI_6434_2004.txt
...
</pre></div>
</div>
<p><strong>Note</strong>: the files in <code class="docutils literal notranslate"><span class="pre">tests/data/test_rainfalldata</span></code> are an incomplete data set for Belgium (RMI rainfall data are not included), an alternative is provided in the section ‘Analysis’.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fmap_rainfall</span> <span class="o">=</span>  <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;../../tests/data/test_rainfalldata&quot;</span><span class="p">)</span>
<span class="n">fmap_erosivity</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;../../tests/data/test_erosivitydata&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">load_rain_folder</span></code> function to read all rain data in a folder:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">all_rainfall</span> <span class="o">=</span> <span class="n">load_rain_folder</span><span class="p">(</span><span class="n">fmap_rainfall</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 581/581 [00:04&lt;00:00, 138.92it/s]
</pre></div></div>
</div>
<p><strong>Compute rainfall statistics</strong> (and add station metadata)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/belgium/stations.csv&quot;</span><span class="p">)</span>

<span class="n">rain_stats</span> <span class="o">=</span> <span class="n">compute_rainfall_statistics</span><span class="p">(</span><span class="n">all_rainfall</span><span class="p">,</span> <span class="n">stations</span><span class="p">)</span>
<span class="n">rain_stats</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>station</th>
      <th>x</th>
      <th>y</th>
      <th>records</th>
      <th>min</th>
      <th>median</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[2018]</td>
      <td>P01_001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2718</td>
      <td>0.01</td>
      <td>0.09</td>
      <td>5.05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[2005, 2006, 2007, 2008, 2009, 2010, 2011, 201...</td>
      <td>P01_003</td>
      <td>51907.0</td>
      <td>191193.0</td>
      <td>56546</td>
      <td>0.01</td>
      <td>0.10</td>
      <td>24.32</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[2005, 2006, 2007, 2008, 2009, 2010, 2011, 201...</td>
      <td>P01_010</td>
      <td>45836.0</td>
      <td>171260.0</td>
      <td>54543</td>
      <td>0.01</td>
      <td>0.10</td>
      <td>22.75</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[2005, 2006, 2007, 2008, 2009, 2010, 2011, 201...</td>
      <td>P01_015</td>
      <td>37391.0</td>
      <td>203053.0</td>
      <td>52304</td>
      <td>0.01</td>
      <td>0.10</td>
      <td>21.61</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[2009, 2010, 2011, 2012, 2013, 2014, 2015, 201...</td>
      <td>P01_029</td>
      <td>25566.0</td>
      <td>198775.0</td>
      <td>36628</td>
      <td>0.01</td>
      <td>0.12</td>
      <td>15.75</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Select stations to compute erosivity for</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">consider_stations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../tests/data/files_tests.csv&quot;</span><span class="p">)</span>

<span class="n">sel_rainfall</span> <span class="o">=</span> <span class="n">all_rainfall</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">all_rainfall</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">consider_stations</span><span class="p">[</span><span class="s2">&quot;datafile&quot;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sel_rainfall</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>minutes_since</th>
      <th>rain_mm</th>
      <th>datetime</th>
      <th>station</th>
      <th>year</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>130</td>
      <td>0.27</td>
      <td>2018-01-01 02:10:00</td>
      <td>P01_001</td>
      <td>2018</td>
      <td>P01_001_2018</td>
    </tr>
    <tr>
      <th>1</th>
      <td>140</td>
      <td>0.02</td>
      <td>2018-01-01 02:20:00</td>
      <td>P01_001</td>
      <td>2018</td>
      <td>P01_001_2018</td>
    </tr>
    <tr>
      <th>2</th>
      <td>190</td>
      <td>0.48</td>
      <td>2018-01-01 03:10:00</td>
      <td>P01_001</td>
      <td>2018</td>
      <td>P01_001_2018</td>
    </tr>
    <tr>
      <th>3</th>
      <td>460</td>
      <td>0.22</td>
      <td>2018-01-01 07:40:00</td>
      <td>P01_001</td>
      <td>2018</td>
      <td>P01_001_2018</td>
    </tr>
    <tr>
      <th>4</th>
      <td>470</td>
      <td>0.09</td>
      <td>2018-01-01 07:50:00</td>
      <td>P01_001</td>
      <td>2018</td>
      <td>P01_001_2018</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Run Model</strong></p>
<p>By default, the erosivity is calculated with the <code class="docutils literal notranslate"><span class="pre">maximum_intensity</span></code> method implemented in Python, which follows a slightly different approach to the original Matlab implementation. However, one can opt to use the <code class="docutils literal notranslate"><span class="pre">matlab_clone</span></code> method as well, which is a Python implementation mimicking the original Matlab one:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">erosivity</span> <span class="o">=</span> <span class="n">compute_erosivity</span><span class="p">(</span><span class="n">sel_rainfall</span><span class="p">,</span> <span class="n">maximum_intensity_matlab_clone</span><span class="p">)</span>
<span class="n">erosivity</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>event_rain_cum</th>
      <th>max_30min_intensity</th>
      <th>event_energy</th>
      <th>erosivity</th>
      <th>all_event_rain_cum</th>
      <th>erosivity_cum</th>
      <th>station</th>
      <th>year</th>
      <th>tag</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-01 14:30:00</th>
      <td>2018-01-01 14:30:00</td>
      <td>11.29</td>
      <td>3.28</td>
      <td>1.530117</td>
      <td>5.018784</td>
      <td>1.08</td>
      <td>5.018784</td>
      <td>P01_001</td>
      <td>2018</td>
      <td>P01_001_2018</td>
    </tr>
    <tr>
      <th>2018-01-02 16:30:00</th>
      <td>2018-01-02 16:30:00</td>
      <td>7.76</td>
      <td>3.00</td>
      <td>0.996561</td>
      <td>2.989682</td>
      <td>12.37</td>
      <td>8.008465</td>
      <td>P01_001</td>
      <td>2018</td>
      <td>P01_001_2018</td>
    </tr>
    <tr>
      <th>2018-01-04 09:10:00</th>
      <td>2018-01-04 09:10:00</td>
      <td>2.34</td>
      <td>1.34</td>
      <td>0.242004</td>
      <td>0.324285</td>
      <td>20.13</td>
      <td>8.332750</td>
      <td>P01_001</td>
      <td>2018</td>
      <td>P01_001_2018</td>
    </tr>
    <tr>
      <th>2018-01-05 02:20:00</th>
      <td>2018-01-05 02:20:00</td>
      <td>1.56</td>
      <td>1.48</td>
      <td>0.190453</td>
      <td>0.281871</td>
      <td>22.47</td>
      <td>8.614621</td>
      <td>P01_001</td>
      <td>2018</td>
      <td>P01_001_2018</td>
    </tr>
    <tr>
      <th>2018-01-05 16:00:00</th>
      <td>2018-01-05 16:00:00</td>
      <td>3.33</td>
      <td>6.16</td>
      <td>0.681102</td>
      <td>4.195587</td>
      <td>24.03</td>
      <td>12.810208</td>
      <td>P01_001</td>
      <td>2018</td>
      <td>P01_001_2018</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Analysis">
<h2>Analysis<a class="headerlink" href="#Analysis" title="Permalink to this headline"></a></h2>
<p>If one does not have acces to the RMI data, the output erosivity from the computation with the full data set is provided in this repository as an alternative:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">erosivity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/erosivity_belgium.csv&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">erosivity</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime.1</th>
      <th>event_rain_cum</th>
      <th>max_30min_intensity</th>
      <th>event_energy</th>
      <th>erosivity</th>
      <th>all_event_rain_cum</th>
      <th>erosivity_cum</th>
      <th>station</th>
      <th>year</th>
      <th>tag</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2004-01-07 12:30:00</th>
      <td>2004-01-07 12:30:00</td>
      <td>7.4</td>
      <td>10.6</td>
      <td>1.642414</td>
      <td>17.409589</td>
      <td>0.0</td>
      <td>17.409589</td>
      <td>KMI_6414</td>
      <td>2004</td>
      <td>KMI_6414_2004</td>
    </tr>
    <tr>
      <th>2004-01-08 11:30:00</th>
      <td>2004-01-08 11:30:00</td>
      <td>5.9</td>
      <td>4.8</td>
      <td>0.977963</td>
      <td>4.694222</td>
      <td>7.4</td>
      <td>22.103810</td>
      <td>KMI_6414</td>
      <td>2004</td>
      <td>KMI_6414_2004</td>
    </tr>
    <tr>
      <th>2004-01-11 05:40:00</th>
      <td>2004-01-11 05:40:00</td>
      <td>8.1</td>
      <td>4.8</td>
      <td>1.242868</td>
      <td>5.965767</td>
      <td>14.5</td>
      <td>28.069577</td>
      <td>KMI_6414</td>
      <td>2004</td>
      <td>KMI_6414_2004</td>
    </tr>
    <tr>
      <th>2004-01-11 19:30:00</th>
      <td>2004-01-11 19:30:00</td>
      <td>7.1</td>
      <td>9.6</td>
      <td>1.611688</td>
      <td>15.472204</td>
      <td>22.6</td>
      <td>43.541781</td>
      <td>KMI_6414</td>
      <td>2004</td>
      <td>KMI_6414_2004</td>
    </tr>
    <tr>
      <th>2004-01-12 08:40:00</th>
      <td>2004-01-12 08:40:00</td>
      <td>21.4</td>
      <td>9.6</td>
      <td>3.684080</td>
      <td>35.367172</td>
      <td>29.7</td>
      <td>78.908954</td>
      <td>KMI_6414</td>
      <td>2004</td>
      <td>KMI_6414_2004</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Ukkel</strong></p>
<p>Compute R-factor for specific periods for Ukkel (KMI_6447 and KMI_F3).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">timeseries</span> <span class="o">=</span> <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">1898</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
              <span class="nb">range</span><span class="p">(</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
              <span class="nb">range</span><span class="p">(</span><span class="mi">1898</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
              <span class="nb">range</span><span class="p">(</span><span class="mi">1996</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
              <span class="nb">range</span><span class="p">(</span><span class="mi">1991</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
              <span class="nb">range</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
              <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">timeseries</span><span class="p">:</span>
    <span class="n">rfactor</span> <span class="o">=</span> <span class="n">get_rfactor_station_year</span><span class="p">(</span><span class="n">erosivity</span><span class="p">,[</span><span class="s2">&quot;KMI_6447&quot;</span><span class="p">,</span><span class="s2">&quot;KMI_FS3&quot;</span><span class="p">],</span> <span class="n">period</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R-factor for period from </span><span class="si">{</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> till </span><span class="si">{</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> is: </span><span class="si">{</span><span class="n">rfactor</span><span class="p">[</span><span class="s1">&#39;erosivity_cum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
R-factor for period from 1898 till 2002 is: 1013.45
R-factor for period from 2003 till 2020 is: 1336.40
R-factor for period from 1898 till 2020 is: 1060.71
R-factor for period from 1996 till 2020 is: 1296.98
R-factor for period from 1991 till 2020 is: 1288.96
R-factor for period from 1990 till 2000 is: 1125.57
R-factor for period from 2000 till 2020 is: 1331.83
</pre></div></div>
</div>
<p><strong>Make figure for Ukkel</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rfactor_all</span><span class="o">=</span> <span class="n">get_rfactor_station_year</span><span class="p">(</span><span class="n">erosivity</span><span class="p">,</span> <span class="n">stations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;KMI_FS3&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI_6447&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">))</span>

<span class="n">rfactor_fs3</span> <span class="o">=</span> <span class="n">get_rfactor_station_year</span><span class="p">(</span><span class="n">erosivity</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;KMI_FS3&quot;</span><span class="p">])</span>
<span class="n">rfactor_fs3</span> <span class="o">=</span> <span class="n">rfactor_fs3</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">rfactor_fs3</span><span class="p">[</span><span class="s2">&quot;erosivity_cum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>

<span class="n">rfactor_6447</span> <span class="o">=</span> <span class="n">get_rfactor_station_year</span><span class="p">(</span><span class="n">erosivity</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;KMI_6447&quot;</span><span class="p">])</span>
<span class="n">rfactor_6447</span> <span class="o">=</span> <span class="n">rfactor_6447</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">rfactor_6447</span><span class="p">[</span><span class="s2">&quot;erosivity_cum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>

<span class="c1"># add first line of KMI6447 to end of KMI FS3 in order to make a continuous timeseries on the plot</span>
<span class="n">rfactor_fs3</span> <span class="o">=</span> <span class="n">rfactor_fs3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rfactor_6447</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rfactor_fs3</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">rfactor_fs3</span><span class="p">[</span><span class="s2">&quot;erosivity_cum&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;KMI_FS3 (1898-2002)&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rfactor_6447</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">rfactor_6447</span><span class="p">[</span><span class="s2">&quot;erosivity_cum&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;KMI_6447 (2003-2020)&quot;</span><span class="p">)</span>

<span class="c1"># rolling mean</span>
<span class="n">rfactor_all</span> <span class="o">=</span> <span class="n">get_rfactor_station_year</span><span class="p">(</span><span class="n">erosivity</span><span class="p">,</span> <span class="n">stations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;KMI_FS3&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI_6447&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
<span class="n">windows</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
<span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">rfactor_all</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)[</span><span class="s2">&quot;erosivity_cum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rfactor_all</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Moving average (</span><span class="si">{</span><span class="n">window</span><span class="si">}</span><span class="s2"> year window)&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3500</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">1890</span><span class="p">,</span><span class="mi">2020</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Yearly R-factor [MJ mm ha$^{-1}$ h$^{-1}$ year$^{-1}$]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f760b09dcf8&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_analysis_flanders_24_1.png" src="../_images/notebooks_analysis_flanders_24_1.png" />
</div>
</div>
<p><strong>All stations expect Ukkel</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stations_belgium_excl_ukkel</span> <span class="o">=</span> <span class="p">[</span><span class="n">station</span> <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span>
                               <span class="k">if</span> <span class="n">station</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;KMI_6447&quot;</span><span class="p">,</span><span class="s2">&quot;KMI_FS3&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI1990_2002&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI2003_nu_v2&quot;</span><span class="p">]]</span>
<span class="n">years</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1898</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span> <span class="k">if</span> <span class="n">year</span> <span class="ow">in</span>
         <span class="n">erosivity</span><span class="p">[</span><span class="n">erosivity</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">stations_belgium_excl_ukkel</span><span class="p">)][</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>

<span class="n">rfactor_non_ukkel</span> <span class="o">=</span> <span class="n">get_rfactor_station_year</span><span class="p">(</span><span class="n">erosivity</span><span class="p">,</span>
                                             <span class="n">stations</span><span class="o">=</span><span class="n">stations_belgium_excl_ukkel</span><span class="p">,</span>
                                             <span class="n">years</span><span class="o">=</span><span class="n">years</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rfactor_non_ukkel</span><span class="p">[</span><span class="s2">&quot;erosivity_cum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">len</span><span class="p">(</span><span class="n">rfactor_non_ukkel</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1257.379735478444
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
55
</pre></div></div>
</div>
<p><strong>All stations flanders</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stations_flanders</span> <span class="o">=</span> <span class="p">[</span><span class="n">station</span> <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span>
                     <span class="k">if</span> <span class="n">station</span> <span class="ow">not</span> <span class="ow">in</span>  <span class="p">[</span><span class="s2">&quot;KMI_6447&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI_FS3&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI_6455&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI_6459&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;KMI_6472&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI_6494&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI_6484&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI1990_2002&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI2003_nu_v2&quot;</span><span class="p">]]</span>
<span class="n">years</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1898</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span> <span class="k">if</span> <span class="n">year</span> <span class="ow">in</span>
         <span class="n">erosivity</span><span class="p">[</span><span class="n">erosivity</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">stations_flanders</span><span class="p">)][</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>

<span class="n">rfactor_flanders</span> <span class="o">=</span> <span class="n">get_rfactor_station_year</span><span class="p">(</span><span class="n">erosivity</span><span class="p">,</span><span class="n">stations_flanders</span><span class="p">,</span> <span class="n">years</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rfactor_flanders</span><span class="p">[</span><span class="s2">&quot;erosivity_cum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">len</span><span class="p">(</span><span class="n">rfactor_flanders</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1237.3075804931602
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
50
</pre></div></div>
</div>
<p><strong>Plot the distribution of all R-values for Belgium, excluding the data from Ukkel</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1991</span><span class="p">,</span> <span class="mi">2021</span><span class="p">)</span> <span class="k">if</span> <span class="n">year</span> <span class="ow">in</span>
         <span class="n">erosivity</span><span class="p">[</span><span class="n">erosivity</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">stations_belgium_excl_ukkel</span><span class="p">)][</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>

<span class="n">rfactor_non_ukkel</span> <span class="o">=</span> <span class="n">get_rfactor_station_year</span><span class="p">(</span><span class="n">erosivity</span><span class="p">,</span> <span class="n">stations_belgium_excl_ukkel</span><span class="p">,</span> <span class="n">years</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rfactor_non_ukkel</span><span class="p">[</span><span class="s2">&quot;erosivity_cum&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Jaarlijkse waarden voor alle 55 stations in België&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1239</span><span class="p">,</span> <span class="mi">1239</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ukkel (30-jaar referentie periode)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R-waarde [MJ mm ha$^{-1}$ h$^{-1}$ jaar$^{-1}$]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">130</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f760fcc1128&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_analysis_flanders_30_1.png" src="../_images/notebooks_analysis_flanders_30_1.png" />
</div>
</div>
<p><strong>All stations of the VMM (Flanders)</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stations_vmm</span> <span class="o">=</span> <span class="p">[</span><span class="n">station</span> <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;KMI&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">station</span><span class="p">]</span>

<span class="n">rfactor_vmm</span> <span class="o">=</span> <span class="n">get_rfactor_station_year</span><span class="p">(</span><span class="n">erosivity</span><span class="p">,</span> <span class="n">stations_vmm</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rfactor_vmm</span><span class="p">[</span><span class="s2">&quot;erosivity_cum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">len</span><span class="p">(</span><span class="n">rfactor_vmm</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1237.077014785147
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
43
</pre></div></div>
</div>
<p><strong>Compute values per year over all stations</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">get_rfactor_station_year</span><span class="p">(</span><span class="n">erosivity</span><span class="p">)</span>
 <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;station&quot;</span><span class="p">)</span>
 <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;erosivity_cum&quot;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">],</span>
     <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;count&quot;</span><span class="p">})</span>
 <span class="o">.</span><span class="n">sort_values</span><span class="p">((</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">),</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
 <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>station</th>
      <th colspan="2" halign="left">erosivity_cum</th>
      <th>year</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>KMI_FS3</td>
      <td>1013.447980</td>
      <td>372.030461</td>
      <td>105</td>
    </tr>
    <tr>
      <th>1</th>
      <td>KMI_6459</td>
      <td>1342.419073</td>
      <td>585.411025</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>KMI_6455</td>
      <td>1203.791757</td>
      <td>578.286308</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>KMI_6434</td>
      <td>1395.650915</td>
      <td>505.788697</td>
      <td>18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>KMI_6472</td>
      <td>1283.746950</td>
      <td>664.442273</td>
      <td>18</td>
    </tr>
    <tr>
      <th>5</th>
      <td>KMI_6447</td>
      <td>1336.397628</td>
      <td>717.022599</td>
      <td>18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>KMI_6484</td>
      <td>1447.547987</td>
      <td>410.672521</td>
      <td>17</td>
    </tr>
    <tr>
      <th>7</th>
      <td>KMI_6414</td>
      <td>1351.436871</td>
      <td>657.902434</td>
      <td>17</td>
    </tr>
    <tr>
      <th>8</th>
      <td>P11_007</td>
      <td>1293.762120</td>
      <td>498.526282</td>
      <td>16</td>
    </tr>
    <tr>
      <th>9</th>
      <td>P08_009</td>
      <td>1312.770803</td>
      <td>784.515398</td>
      <td>16</td>
    </tr>
    <tr>
      <th>10</th>
      <td>P09_016</td>
      <td>1277.558439</td>
      <td>605.450071</td>
      <td>16</td>
    </tr>
    <tr>
      <th>11</th>
      <td>P03_017</td>
      <td>1492.972795</td>
      <td>641.917534</td>
      <td>16</td>
    </tr>
    <tr>
      <th>12</th>
      <td>P03_005</td>
      <td>1282.562029</td>
      <td>415.816142</td>
      <td>16</td>
    </tr>
    <tr>
      <th>13</th>
      <td>P08_018</td>
      <td>1377.282162</td>
      <td>796.665508</td>
      <td>16</td>
    </tr>
    <tr>
      <th>14</th>
      <td>P02_008</td>
      <td>1107.936325</td>
      <td>413.800105</td>
      <td>16</td>
    </tr>
    <tr>
      <th>15</th>
      <td>P02_004</td>
      <td>1378.959393</td>
      <td>909.600748</td>
      <td>16</td>
    </tr>
    <tr>
      <th>16</th>
      <td>P08_013</td>
      <td>1189.783684</td>
      <td>545.068058</td>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>P01_015</td>
      <td>1090.112730</td>
      <td>437.259380</td>
      <td>16</td>
    </tr>
    <tr>
      <th>18</th>
      <td>P01_010</td>
      <td>1449.691160</td>
      <td>622.033426</td>
      <td>16</td>
    </tr>
    <tr>
      <th>19</th>
      <td>P01_003</td>
      <td>1418.290092</td>
      <td>767.219120</td>
      <td>16</td>
    </tr>
    <tr>
      <th>20</th>
      <td>P07_006</td>
      <td>1044.724301</td>
      <td>409.969541</td>
      <td>16</td>
    </tr>
    <tr>
      <th>21</th>
      <td>P09_012</td>
      <td>1152.069795</td>
      <td>484.212211</td>
      <td>16</td>
    </tr>
    <tr>
      <th>22</th>
      <td>P06_014</td>
      <td>1071.548622</td>
      <td>278.587932</td>
      <td>15</td>
    </tr>
    <tr>
      <th>23</th>
      <td>P10_011</td>
      <td>1150.559920</td>
      <td>413.434757</td>
      <td>15</td>
    </tr>
    <tr>
      <th>24</th>
      <td>P11_002</td>
      <td>1277.225780</td>
      <td>718.007959</td>
      <td>15</td>
    </tr>
    <tr>
      <th>25</th>
      <td>KMI_6477</td>
      <td>1345.682044</td>
      <td>658.148797</td>
      <td>15</td>
    </tr>
    <tr>
      <th>26</th>
      <td>P05_019</td>
      <td>834.893640</td>
      <td>187.452290</td>
      <td>14</td>
    </tr>
    <tr>
      <th>27</th>
      <td>P07_021</td>
      <td>1024.883579</td>
      <td>567.140448</td>
      <td>14</td>
    </tr>
    <tr>
      <th>28</th>
      <td>P07_022</td>
      <td>1290.671931</td>
      <td>447.699099</td>
      <td>14</td>
    </tr>
    <tr>
      <th>29</th>
      <td>P11_024</td>
      <td>1448.570922</td>
      <td>1059.335762</td>
      <td>14</td>
    </tr>
    <tr>
      <th>30</th>
      <td>P04_020</td>
      <td>1155.457860</td>
      <td>585.477272</td>
      <td>13</td>
    </tr>
    <tr>
      <th>31</th>
      <td>P04_001</td>
      <td>1537.649048</td>
      <td>485.756724</td>
      <td>13</td>
    </tr>
    <tr>
      <th>32</th>
      <td>KMI_6439</td>
      <td>1169.529461</td>
      <td>480.978707</td>
      <td>13</td>
    </tr>
    <tr>
      <th>33</th>
      <td>P08_031</td>
      <td>1198.694291</td>
      <td>611.355465</td>
      <td>12</td>
    </tr>
    <tr>
      <th>34</th>
      <td>P08_028</td>
      <td>1137.982185</td>
      <td>728.176289</td>
      <td>12</td>
    </tr>
    <tr>
      <th>35</th>
      <td>P09_025</td>
      <td>1142.020684</td>
      <td>533.306992</td>
      <td>12</td>
    </tr>
    <tr>
      <th>36</th>
      <td>P09_032</td>
      <td>1399.275294</td>
      <td>850.543054</td>
      <td>12</td>
    </tr>
    <tr>
      <th>37</th>
      <td>P09_026</td>
      <td>1102.756760</td>
      <td>559.757068</td>
      <td>12</td>
    </tr>
    <tr>
      <th>38</th>
      <td>P04_027</td>
      <td>1210.151071</td>
      <td>425.203837</td>
      <td>12</td>
    </tr>
    <tr>
      <th>39</th>
      <td>P06_040</td>
      <td>1083.610845</td>
      <td>320.083690</td>
      <td>12</td>
    </tr>
    <tr>
      <th>40</th>
      <td>P03_041</td>
      <td>1066.256349</td>
      <td>364.446664</td>
      <td>12</td>
    </tr>
    <tr>
      <th>41</th>
      <td>P01_029</td>
      <td>1332.382381</td>
      <td>996.246264</td>
      <td>12</td>
    </tr>
    <tr>
      <th>42</th>
      <td>P05_039</td>
      <td>1362.462917</td>
      <td>670.997759</td>
      <td>12</td>
    </tr>
    <tr>
      <th>43</th>
      <td>P03_036</td>
      <td>1462.484563</td>
      <td>844.271765</td>
      <td>12</td>
    </tr>
    <tr>
      <th>44</th>
      <td>P01_037</td>
      <td>886.616101</td>
      <td>279.273285</td>
      <td>12</td>
    </tr>
    <tr>
      <th>45</th>
      <td>P11_043</td>
      <td>1388.573908</td>
      <td>868.620922</td>
      <td>12</td>
    </tr>
    <tr>
      <th>46</th>
      <td>P08_033</td>
      <td>1423.522459</td>
      <td>620.629392</td>
      <td>11</td>
    </tr>
    <tr>
      <th>47</th>
      <td>P09_034</td>
      <td>1157.774954</td>
      <td>462.258067</td>
      <td>11</td>
    </tr>
    <tr>
      <th>48</th>
      <td>P09_035</td>
      <td>1670.461762</td>
      <td>945.339789</td>
      <td>11</td>
    </tr>
    <tr>
      <th>49</th>
      <td>P08_023</td>
      <td>1040.904464</td>
      <td>454.344420</td>
      <td>10</td>
    </tr>
    <tr>
      <th>50</th>
      <td>P10_042</td>
      <td>1237.331122</td>
      <td>565.793083</td>
      <td>10</td>
    </tr>
    <tr>
      <th>51</th>
      <td>P02_030</td>
      <td>1077.718705</td>
      <td>323.032167</td>
      <td>9</td>
    </tr>
    <tr>
      <th>52</th>
      <td>P05_038</td>
      <td>968.648040</td>
      <td>238.527416</td>
      <td>9</td>
    </tr>
    <tr>
      <th>53</th>
      <td>KMI_6418</td>
      <td>823.844453</td>
      <td>377.651136</td>
      <td>8</td>
    </tr>
    <tr>
      <th>54</th>
      <td>KMI_6494</td>
      <td>2378.797416</td>
      <td>812.871388</td>
      <td>8</td>
    </tr>
    <tr>
      <th>55</th>
      <td>KMI_6464</td>
      <td>1121.448030</td>
      <td>584.265294</td>
      <td>8</td>
    </tr>
    <tr>
      <th>56</th>
      <td>KMI_6431</td>
      <td>1042.802421</td>
      <td>271.880632</td>
      <td>6</td>
    </tr>
    <tr>
      <th>57</th>
      <td>P04__01</td>
      <td>1050.077755</td>
      <td>645.674255</td>
      <td>2</td>
    </tr>
    <tr>
      <th>58</th>
      <td>P01_001</td>
      <td>410.447246</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Analysis-(monthly-resolution)">
<h2>Analysis (monthly resolution)<a class="headerlink" href="#Analysis-(monthly-resolution)" title="Permalink to this headline"></a></h2>
<p>Get the EI30-values for 2018 based on two Ukkel station (“KMI_6447”,“KMI_FS3”)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">erosivity_monthly</span> <span class="o">=</span> <span class="p">(</span><span class="n">erosivity</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">erosivity</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;KMI_6447&quot;</span><span class="p">,</span> <span class="s2">&quot;KMI_FS3&quot;</span><span class="p">]),</span> <span class="s2">&quot;erosivity&quot;</span><span class="p">]</span>
                     <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span>
                     <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">to_frame</span><span class="p">())</span>
<span class="n">erosivity_monthly</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">erosivity_monthly</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>
<span class="n">erosivity_monthly</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>erosivity</th>
      <th>month</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1898-01-31</th>
      <td>4.207924</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1898-02-28</th>
      <td>31.135034</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1898-03-31</th>
      <td>20.293480</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1898-04-30</th>
      <td>19.440921</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1898-05-31</th>
      <td>31.670560</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Get mean and interquartile range of monthly R-factor</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">em</span> <span class="o">=</span> <span class="p">(</span><span class="n">erosivity_monthly</span>
      <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">aggregate</span><span class="p">({</span>
          <span class="s2">&quot;erosivity&quot;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
                       <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
                       <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">75</span><span class="p">)]</span>
      <span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">em</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="s2">&quot;erosivity&quot;</span><span class="p">][</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span>
<span class="n">em</span><span class="p">[</span><span class="s2">&quot;l_e&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="s2">&quot;erosivity&quot;</span><span class="p">][</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">em</span><span class="p">[</span><span class="s2">&quot;erosivity&quot;</span><span class="p">][</span><span class="s2">&quot;&lt;lambda_0&gt;&quot;</span><span class="p">]</span>
<span class="n">em</span><span class="p">[</span><span class="s2">&quot;u_e&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="s2">&quot;erosivity&quot;</span><span class="p">][</span><span class="s2">&quot;&lt;lambda_1&gt;&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">em</span><span class="p">[</span><span class="s2">&quot;erosivity&quot;</span><span class="p">][</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p><strong>Plot</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">em</span><span class="p">))</span>
<span class="n">y_gv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">26</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span>
<span class="n">y_gv2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">43</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span><span class="n">em</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">em</span><span class="p">[[</span><span class="s2">&quot;l_e&quot;</span><span class="p">,</span><span class="s2">&quot;u_e&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.80</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ukkel (1898-2020))&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y_gv</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Verstraeten $\it{et. al}$ (2001)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">0.3</span><span class="p">,</span><span class="n">y_gv2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Verstraeten $\it{et. al}$ (2006)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;R-value&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="s2">&quot;Januari&quot;</span><span class="p">,</span><span class="s2">&quot;Februari&quot;</span><span class="p">,</span><span class="s2">&quot;Maart&quot;</span><span class="p">,</span><span class="s2">&quot;April&quot;</span><span class="p">,</span><span class="s2">&quot;Mei&quot;</span><span class="p">,</span><span class="s2">&quot;Juni&quot;</span><span class="p">,</span><span class="s2">&quot;Juli&quot;</span><span class="p">,</span><span class="s2">&quot;Augustus&quot;</span><span class="p">,</span><span class="s2">&quot;September&quot;</span><span class="p">,</span><span class="s2">&quot;Oktober&quot;</span><span class="p">,</span><span class="s2">&quot;November&quot;</span><span class="p">,</span><span class="s2">&quot;December&quot;</span><span class="p">],</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R-waarde [MJ mm ha$^{-1}$ h$^{-1}$ maand$^{-1}$]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_analysis_flanders_41_0.png" src="../_images/notebooks_analysis_flanders_41_0.png" />
</div>
</div>
</section>
<section id="Additional:-monthly-analysis-(detail)">
<h2>Additional: monthly analysis (detail)<a class="headerlink" href="#Additional:-monthly-analysis-(detail)" title="Permalink to this headline"></a></h2>
<p><strong>Evolution monthly R-value</strong></p>
<p>Generate plot to analyse evolution of montly R over the years</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">subplot_montlhy_R</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">ind1</span><span class="p">,</span><span class="n">ind2</span><span class="p">):</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ind1</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ind2</span><span class="o">==</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;erosivity&quot;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;EI30&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;erosivity&quot;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="mi">1998</span><span class="p">,</span><span class="mi">2021</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="c1"># rolling mean</span>
    <span class="n">scales</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">scales</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;erosivity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">scale</span><span class="o">==</span><span class="mi">10</span><span class="p">:</span>
            <span class="n">y_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">+</span><span class="mi">1898</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;voortschrijdend gemiddelde (</span><span class="si">{</span><span class="n">scale</span><span class="si">}</span><span class="s1"> jaar)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ind1</span><span class="o">!=</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ind2</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Jaar (-)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ind2</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ind1</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t\t\t</span><span class="s1"> Maandelijkse R [MJ mm ha$^{-1}$ h$^{-1}$ maand$^{-1}$]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ind1</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ind2</span><span class="o">==</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">months</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Januari&quot;</span><span class="p">,</span><span class="s2">&quot;Februari&quot;</span><span class="p">,</span><span class="s2">&quot;Maart&quot;</span><span class="p">,</span><span class="s2">&quot;April&quot;</span><span class="p">,</span><span class="s2">&quot;Mei&quot;</span><span class="p">,</span><span class="s2">&quot;Juni&quot;</span><span class="p">,</span><span class="s2">&quot;Juli&quot;</span><span class="p">,</span><span class="s2">&quot;Augustus&quot;</span><span class="p">,</span><span class="s2">&quot;September&quot;</span><span class="p">,</span><span class="s2">&quot;Oktober&quot;</span><span class="p">,</span><span class="s2">&quot;November&quot;</span><span class="p">,</span><span class="s2">&quot;December&quot;</span><span class="p">]</span>
<span class="n">erosivity_monthly</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">erosivity_monthly</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>

<span class="k">for</span> <span class="n">month</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">months</span><span class="p">):</span>
    <span class="n">ind1</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">month</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">ind2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">month</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">df_plot</span> <span class="o">=</span> <span class="n">erosivity_monthly</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">erosivity_monthly</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">month</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">df_plot</span>  <span class="o">=</span> <span class="n">df_plot</span> <span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_plot</span><span class="p">[</span><span class="s2">&quot;erosivity&quot;</span><span class="p">])]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
    <span class="n">subplot_montlhy_R</span><span class="p">(</span><span class="n">df_plot</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="n">ind1</span><span class="p">,</span><span class="n">ind2</span><span class="p">],</span><span class="n">ind1</span><span class="p">,</span><span class="n">ind2</span><span class="p">)</span>


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_analysis_flanders_43_0.png" src="../_images/notebooks_analysis_flanders_43_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../api/rfactor.html" class="btn btn-neutral float-left" title="rfactor package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../codelegacy.html" class="btn btn-neutral float-right" title="Code legacy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Sacha Gobeyn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>